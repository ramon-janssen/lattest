<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="annot"><span class="hs-comment">{- |
    This module contains building blocks for constructing out-of-the-box 'TestController's.
    
    'TestController's have multiple duties during testing:
    
    * selecting test inputs,
    * deciding whether to continue testing,
    * returning testing results (other than 'Pass' or 'Fail'), and
    * potentially performing side effects during testing.
    
    The building blocks in this module allow composing 'TestController's in a modular way, by combining various choices for these responsibilities.
    Every building block carries its own state. For example, to stop testing after a fixed number of steps, a state in the form of a counter is
    needed, whereas returning the observed trace as test result requires recording the observed trace as state.
-}</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Lattest.Exec.StandardTestControllers</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span class="annot"><span class="hs-comment">-- * Test Selectors</span></span><span>
</span><span id="line-23"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#selector"><span class="hs-identifier">selector</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSelector"><span class="hs-identifier">TestSelector</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelector"><span class="hs-identifier">randomTestSelector</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelectorFromSeed"><span class="hs-identifier">randomTestSelectorFromSeed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelectorFromGen"><span class="hs-identifier">randomTestSelectorFromGen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span class="annot"><span class="hs-comment">-- * Stop Conditions</span></span><span>
</span><span id="line-29"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#StopCondition"><span class="hs-identifier">StopCondition</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#stopCondition"><span class="hs-identifier">stopCondition</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#untilCondition"><span class="hs-identifier">untilCondition</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#stopAfterSteps"><span class="hs-identifier">stopAfterSteps</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span class="annot"><span class="hs-comment">-- * Test Observers</span></span><span>
</span><span id="line-34"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestObserver"><span class="hs-identifier">TestObserver</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#observer"><span class="hs-identifier">observer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#andObservingWith"><span class="hs-identifier">andObservingWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#andObserving"><span class="hs-identifier">andObserving</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#observingOnly"><span class="hs-identifier">observingOnly</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#traceObserver"><span class="hs-identifier">traceObserver</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#stateObserver"><span class="hs-identifier">stateObserver</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#inconclusiveStateObserver"><span class="hs-identifier">inconclusiveStateObserver</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span class="annot"><span class="hs-comment">-- * Test Side Effects</span></span><span>
</span><span id="line-43"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSideEffect"><span class="hs-identifier">TestSideEffect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#withSideEffect"><span class="hs-identifier">withSideEffect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#testSideEffect"><span class="hs-identifier">testSideEffect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#printActions"><span class="hs-identifier">printActions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#printState"><span class="hs-identifier">printState</span></a></span><span>
</span><span id="line-48"></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html"><span class="hs-identifier">Lattest.Exec.Testing</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier">TestController</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Lattest.Model.Alphabet.html"><span class="hs-identifier">Lattest.Model.Alphabet</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Lattest.Model.Alphabet.html#TestChoice"><span class="hs-identifier">TestChoice</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Alphabet.html#IOAct"><span class="hs-identifier">IOAct</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Alphabet.html#IOSuspAct"><span class="hs-identifier">IOSuspAct</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Alphabet.html#Suspended"><span class="hs-identifier">Suspended</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Alphabet.html#asSuspended"><span class="hs-identifier">asSuspended</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Alphabet.html#actToChoice"><span class="hs-identifier">actToChoice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html"><span class="hs-identifier">Lattest.Model.Automaton</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Lattest.Model.Automaton.html#AutIntrpr"><span class="hs-identifier">AutIntrpr</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#AutomatonSemantics"><span class="hs-identifier">AutomatonSemantics</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#TransitionSemantics"><span class="hs-identifier">TransitionSemantics</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#FiniteMenu"><span class="hs-identifier">FiniteMenu</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#specifiedMenu"><span class="hs-identifier">specifiedMenu</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#stateConf"><span class="hs-identifier">stateConf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Lattest.Model.BoundedMonad.html"><span class="hs-identifier">Lattest.Model.BoundedMonad</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Lattest.Model.BoundedMonad.html#isConclusive"><span class="hs-identifier">isConclusive</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.BoundedMonad.html#BoundedConfiguration"><span class="hs-identifier">BoundedConfiguration</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Lattest.Util.Utils.html"><span class="hs-identifier">Lattest.Util.Utils</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Lattest.Util.Utils.html#takeRandom"><span class="hs-identifier">takeRandom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Util.Utils.html#takeJusts"><span class="hs-identifier">takeJusts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isLeft</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either.Combinators</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">leftToMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maybeToLeft</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">keys</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">size</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">elemAt</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">union</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RandomGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StdGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">initStdGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mkStdGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">uniformR</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><span class="hs-comment">{- |
    'Testselector's are test controllers that are only concerned with selecting inputs for testing. They do not return any testing results.
-}</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">type</span><span> </span><span id="TestSelector"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSelector"><span class="hs-identifier hs-var">TestSelector</span></a></span></span><span> </span><span id="local-6989586621679292371"><span class="annot"><a href="#local-6989586621679292371"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679292372"><span class="annot"><a href="#local-6989586621679292372"><span class="hs-identifier hs-type">loc</span></a></span></span><span> </span><span id="local-6989586621679292373"><span class="annot"><a href="#local-6989586621679292373"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span id="local-6989586621679292374"><span class="annot"><a href="#local-6989586621679292374"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679292375"><span class="annot"><a href="#local-6989586621679292375"><span class="hs-identifier hs-type">tdest</span></a></span></span><span> </span><span id="local-6989586621679292376"><span class="annot"><a href="#local-6989586621679292376"><span class="hs-identifier hs-type">act</span></a></span></span><span> </span><span id="local-6989586621679292377"><span class="annot"><a href="#local-6989586621679292377"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679292378"><span class="annot"><a href="#local-6989586621679292378"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292371"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292372"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292373"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292374"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292375"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292376"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292377"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292378"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><span class="hs-comment">{- |
    Create a 'TestSelector'. Requires one function to select an input, also updating the state, and one function to update the state when observing
    an action.
-}</span></span><span>
</span><span id="line-73"></span><span id="local-6989586621679291881"><span id="local-6989586621679291882"><span id="local-6989586621679291884"><span id="local-6989586621679291885"><span id="local-6989586621679291886"><span id="local-6989586621679291887"><span id="local-6989586621679291888"><span id="local-6989586621679291889"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#selector"><span class="hs-identifier hs-type">selector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lattest.Model.Alphabet.html#TestChoice"><span class="hs-identifier hs-type">TestChoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291881"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291882"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="#local-6989586621679291884"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679291884"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#AutIntrpr"><span class="hs-identifier hs-type">AutIntrpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291885"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291886"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291887"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291888"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291889"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291882"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679291885"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291887"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679291881"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679291884"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679291884"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#AutIntrpr"><span class="hs-identifier hs-type">AutIntrpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291885"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291886"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291887"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291888"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291889"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291882"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679291882"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679291885"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291887"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679291884"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSelector"><span class="hs-identifier hs-type">TestSelector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291885"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291886"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291887"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291888"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291889"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291882"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291884"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291881"><span class="hs-identifier hs-type">i</span></a></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-78"></span><span id="selector"><span class="annot"><span class="annottext">selector :: forall i act state (m :: * -&gt; *) loc q t tdest.
TestChoice i act =&gt;
state
-&gt; (state
    -&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Maybe (i, state)))
-&gt; (state
    -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe state))
-&gt; TestSelector m loc q t tdest act state i
</span><a href="Lattest.Exec.StandardTestControllers.html#selector"><span class="hs-identifier hs-var hs-var">selector</span></a></span></span><span> </span><span id="local-6989586621679292384"><span class="annot"><span class="annottext">state
</span><a href="#local-6989586621679292384"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621679292385"><span class="annot"><span class="annottext">state
-&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Maybe (i, state))
</span><a href="#local-6989586621679292385"><span class="hs-identifier hs-var">sel</span></a></span></span><span> </span><span id="local-6989586621679292386"><span class="annot"><span class="annottext">state
-&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe state)
</span><a href="#local-6989586621679292386"><span class="hs-identifier hs-var">upd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="annottext">testControllerState :: state
</span><a href="Lattest.Exec.Testing.html#testControllerState"><span class="hs-identifier hs-var">testControllerState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">state
</span><a href="#local-6989586621679292384"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">selectTest :: TestChoice i act =&gt;
state
-&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Either (i, state) ())
</span><a href="Lattest.Exec.Testing.html#selectTest"><span class="hs-identifier hs-var">selectTest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292391"><span class="annot"><span class="annottext">state
</span><a href="#local-6989586621679292391"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679292392"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292392"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span id="local-6989586621679292393"><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292393"><span class="hs-identifier hs-var">mq</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe (i, state) -&gt; Either (i, state) ()
forall b a. b -&gt; Maybe a -&gt; Either a b
</span><span class="hs-identifier hs-var">maybeToLeft</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (i, state) -&gt; Either (i, state) ())
-&gt; IO (Maybe (i, state)) -&gt; IO (Either (i, state) ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">state
-&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Maybe (i, state))
</span><a href="#local-6989586621679292385"><span class="hs-identifier hs-var">sel</span></a></span><span> </span><span class="annot"><span class="annottext">state
</span><a href="#local-6989586621679292391"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292392"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292393"><span class="hs-identifier hs-var">mq</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">updateTestController :: state
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either state ())
</span><a href="Lattest.Exec.Testing.html#updateTestController"><span class="hs-identifier hs-var">updateTestController</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292396"><span class="annot"><span class="annottext">state
</span><a href="#local-6989586621679292396"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679292397"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292397"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span id="local-6989586621679292398"><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292398"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679292399"><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292399"><span class="hs-identifier hs-var">mq</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe state -&gt; Either state ()
forall b a. b -&gt; Maybe a -&gt; Either a b
</span><span class="hs-identifier hs-var">maybeToLeft</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe state -&gt; Either state ())
-&gt; IO (Maybe state) -&gt; IO (Either state ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">state
-&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe state)
</span><a href="#local-6989586621679292386"><span class="hs-identifier hs-var">upd</span></a></span><span> </span><span class="annot"><span class="annottext">state
</span><a href="#local-6989586621679292396"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292397"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292398"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292399"><span class="hs-identifier hs-var">mq</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">handleTestClose :: state -&gt; IO ()
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; state -&gt; IO ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; state -&gt; IO ()) -&gt; IO () -&gt; state -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- TODO introduce a combinator that adds the 'selector' behaviour to an arbitrary TestController. This is not needed if the selector is always </span><span>
</span><span id="line-86"></span><span class="hs-comment">-- taken as a basis to combine with stop conditions / test observers, but it would be more flexible to allow turning a composition around.</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><span class="hs-comment">{- |
    A 'TestSelector' that picks inputs uniformly pseudo-randomly from the outgoing transitions from the current state configuration.
-}</span></span><span>
</span><span id="line-91"></span><span id="local-6989586621679291914"><span id="local-6989586621679291915"><span id="local-6989586621679291916"><span id="local-6989586621679291917"><span id="local-6989586621679291918"><span id="local-6989586621679291919"><span id="local-6989586621679291922"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelector"><span class="hs-identifier hs-type">randomTestSelector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lattest.Model.Automaton.html#AutomatonSemantics"><span class="hs-identifier hs-type">AutomatonSemantics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291914"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291915"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291916"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291917"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291918"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291919"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#FiniteMenu"><span class="hs-identifier hs-type">FiniteMenu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291917"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291919"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679291914"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Alphabet.html#TestChoice"><span class="hs-identifier hs-type">TestChoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291922"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291919"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSelector"><span class="hs-identifier hs-type">TestSelector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291914"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291915"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291916"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291917"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291918"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291919"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679291922"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-93"></span><span id="randomTestSelector"><span class="annot"><span class="annottext">randomTestSelector :: forall (m :: * -&gt; *) loc q t tdest act i.
(AutomatonSemantics m loc q t tdest act, FiniteMenu t act,
 Foldable m, TestChoice i act) =&gt;
IO (TestSelector m loc q t tdest act StdGen i)
</span><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelector"><span class="hs-identifier hs-var hs-var">randomTestSelector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO StdGen
forall (m :: * -&gt; *). MonadIO m =&gt; m StdGen
</span><span class="hs-identifier hs-var">initStdGen</span></span><span> </span><span class="annot"><span class="annottext">IO StdGen
-&gt; (StdGen -&gt; IO (TestSelector m loc q t tdest act StdGen i))
-&gt; IO (TestSelector m loc q t tdest act StdGen i)
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">TestSelector m loc q t tdest act StdGen i
-&gt; IO (TestSelector m loc q t tdest act StdGen i)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TestSelector m loc q t tdest act StdGen i
 -&gt; IO (TestSelector m loc q t tdest act StdGen i))
-&gt; (StdGen -&gt; TestSelector m loc q t tdest act StdGen i)
-&gt; StdGen
-&gt; IO (TestSelector m loc q t tdest act StdGen i)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; TestSelector m loc q t tdest act StdGen i
forall (m :: * -&gt; *) loc q t tdest act i g.
(AutomatonSemantics m loc q t tdest act, FiniteMenu t act,
 Foldable m, TestChoice i act, RandomGen g) =&gt;
g -&gt; TestSelector m loc q t tdest act g i
</span><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelectorFromGen"><span class="hs-identifier hs-var">randomTestSelectorFromGen</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><span class="hs-comment">{- |
    A 'TestSelector' that picks inputs uniformly pseudo-randomly from the outgoing transitions from the current state configuration, starting with
    the given random seed.
-}</span></span><span>
</span><span id="line-99"></span><span id="local-6989586621679291947"><span id="local-6989586621679291948"><span id="local-6989586621679291949"><span id="local-6989586621679291950"><span id="local-6989586621679291951"><span id="local-6989586621679291952"><span id="local-6989586621679291953"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelectorFromSeed"><span class="hs-identifier hs-type">randomTestSelectorFromSeed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lattest.Model.Automaton.html#AutomatonSemantics"><span class="hs-identifier hs-type">AutomatonSemantics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291947"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291948"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291949"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291950"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291951"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291952"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#FiniteMenu"><span class="hs-identifier hs-type">FiniteMenu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291950"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291952"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679291947"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Alphabet.html#TestChoice"><span class="hs-identifier hs-type">TestChoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291953"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291952"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSelector"><span class="hs-identifier hs-type">TestSelector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291947"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291948"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291949"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291950"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291951"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291952"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679291953"><span class="hs-identifier hs-type">i</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-101"></span><span id="randomTestSelectorFromSeed"><span class="annot"><span class="annottext">randomTestSelectorFromSeed :: forall (m :: * -&gt; *) loc q t tdest act i.
(AutomatonSemantics m loc q t tdest act, FiniteMenu t act,
 Foldable m, TestChoice i act) =&gt;
Int -&gt; TestSelector m loc q t tdest act StdGen i
</span><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelectorFromSeed"><span class="hs-identifier hs-var hs-var">randomTestSelectorFromSeed</span></a></span></span><span> </span><span id="local-6989586621679292426"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679292426"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; TestSelector m loc q t tdest act StdGen i
forall (m :: * -&gt; *) loc q t tdest act i g.
(AutomatonSemantics m loc q t tdest act, FiniteMenu t act,
 Foldable m, TestChoice i act, RandomGen g) =&gt;
g -&gt; TestSelector m loc q t tdest act g i
</span><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelectorFromGen"><span class="hs-identifier hs-var">randomTestSelectorFromGen</span></a></span><span> </span><span class="annot"><span class="annottext">(StdGen -&gt; TestSelector m loc q t tdest act StdGen i)
-&gt; StdGen -&gt; TestSelector m loc q t tdest act StdGen i
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; StdGen
</span><span class="hs-identifier hs-var">mkStdGen</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679292426"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><span class="hs-comment">{- |
    A 'TestSelector' that picks inputs uniformly pseudo-randomly from the outgoing transitions from the current state configuration, based on the
    given random generator.
-}</span></span><span>
</span><span id="line-107"></span><span id="local-6989586621679291939"><span id="local-6989586621679291940"><span id="local-6989586621679291941"><span id="local-6989586621679291942"><span id="local-6989586621679291943"><span id="local-6989586621679291944"><span id="local-6989586621679291945"><span id="local-6989586621679291946"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelectorFromGen"><span class="hs-identifier hs-type">randomTestSelectorFromGen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lattest.Model.Automaton.html#AutomatonSemantics"><span class="hs-identifier hs-type">AutomatonSemantics</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291939"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291940"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291941"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291942"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291943"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291944"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#FiniteMenu"><span class="hs-identifier hs-type">FiniteMenu</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291942"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291944"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679291939"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lattest.Model.Alphabet.html#TestChoice"><span class="hs-identifier hs-type">TestChoice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291945"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291944"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RandomGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679291946"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679291946"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSelector"><span class="hs-identifier hs-type">TestSelector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291939"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291940"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291941"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291942"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291943"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291944"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291946"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679291945"><span class="hs-identifier hs-type">i</span></a></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-109"></span><span id="randomTestSelectorFromGen"><span class="annot"><span class="annottext">randomTestSelectorFromGen :: forall (m :: * -&gt; *) loc q t tdest act i g.
(AutomatonSemantics m loc q t tdest act, FiniteMenu t act,
 Foldable m, TestChoice i act, RandomGen g) =&gt;
g -&gt; TestSelector m loc q t tdest act g i
</span><a href="Lattest.Exec.StandardTestControllers.html#randomTestSelectorFromGen"><span class="hs-identifier hs-var hs-var">randomTestSelectorFromGen</span></a></span></span><span> </span><span id="local-6989586621679292440"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679292440"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g
-&gt; (g -&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Maybe (i, g)))
-&gt; (g
    -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe g))
-&gt; TestSelector m loc q t tdest act g i
forall i act state (m :: * -&gt; *) loc q t tdest.
TestChoice i act =&gt;
state
-&gt; (state
    -&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Maybe (i, state)))
-&gt; (state
    -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe state))
-&gt; TestSelector m loc q t tdest act state i
</span><a href="Lattest.Exec.StandardTestControllers.html#selector"><span class="hs-identifier hs-var">selector</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679292440"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">g -&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Maybe (i, g))
forall {g} {a} {a} {m :: * -&gt; *} {loc} {q} {t} {tdest} {m :: * -&gt; *}
       {p}.
(RandomGen g, TestChoice a a, AutomatonSemantics m loc q t tdest a,
 Foldable m, FiniteMenu t a, Monad m) =&gt;
g -&gt; AutIntrpr m loc q t tdest a -&gt; p -&gt; m (Maybe (a, g))
</span><a href="#local-6989586621679292441"><span class="hs-identifier hs-var">randomSelectTest</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679292442"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679292442"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">act
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">m q
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe g -&gt; IO (Maybe g)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe g -&gt; IO (Maybe g)) -&gt; Maybe g -&gt; IO (Maybe g)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">g -&gt; Maybe g
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679292442"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621679292441"><span class="annot"><span class="annottext">randomSelectTest :: g -&gt; AutIntrpr m loc q t tdest a -&gt; p -&gt; m (Maybe (a, g))
</span><a href="#local-6989586621679292441"><span class="hs-identifier hs-var hs-var">randomSelectTest</span></a></span></span><span> </span><span id="local-6989586621679292477"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679292477"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679292478"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest a
</span><a href="#local-6989586621679292478"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679292500"><span class="annot"><span class="annottext">ins :: [a]
</span><a href="#local-6989586621679292500"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe a] -&gt; [a]
forall (f :: * -&gt; *) t. Foldable f =&gt; f (Maybe t) -&gt; [t]
</span><a href="Lattest.Util.Utils.html#takeJusts"><span class="hs-identifier hs-var">takeJusts</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe a] -&gt; [a]) -&gt; [Maybe a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall i act. TestChoice i act =&gt; act -&gt; Maybe i
</span><a href="Lattest.Model.Alphabet.html#actToChoice"><span class="hs-identifier hs-var">actToChoice</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; [a] -&gt; [Maybe a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest a -&gt; [a]
forall (m :: * -&gt; *) loc q t tdest act.
(AutomatonSemantics m loc q t tdest act, Foldable m, Ord t,
 FiniteMenu t act) =&gt;
AutIntrpr m loc q t tdest act -&gt; [act]
</span><a href="Lattest.Model.Automaton.html#specifiedMenu"><span class="hs-identifier hs-var">specifiedMenu</span></a></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest a
</span><a href="#local-6989586621679292478"><span class="hs-identifier hs-var">aut</span></a></span><span>
</span><span id="line-113"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679292500"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-114"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m (Maybe (a, g))
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;random test selector found an empty menu&quot;</span></span><span>
</span><span id="line-115"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (a, g) -&gt; m (Maybe (a, g))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (a, g) -&gt; m (Maybe (a, g)))
-&gt; Maybe (a, g) -&gt; m (Maybe (a, g))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a, g) -&gt; Maybe (a, g)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((a, g) -&gt; Maybe (a, g)) -&gt; (a, g) -&gt; Maybe (a, g)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">g -&gt; [a] -&gt; (a, g)
forall g a. RandomGen g =&gt; g -&gt; [a] -&gt; (a, g)
</span><a href="Lattest.Util.Utils.html#takeRandom"><span class="hs-identifier hs-var">takeRandom</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679292477"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679292500"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><span class="hs-comment">{- |
    'StopCondition's are test controllers that are only concerned with deciding whether to continue testing after observing an action. They do not
    select inputs or return any testing results.
-}</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">type</span><span> </span><span id="StopCondition"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#StopCondition"><span class="hs-identifier hs-var">StopCondition</span></a></span></span><span> </span><span id="local-6989586621679292503"><span class="annot"><a href="#local-6989586621679292503"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679292504"><span class="annot"><a href="#local-6989586621679292504"><span class="hs-identifier hs-type">loc</span></a></span></span><span> </span><span id="local-6989586621679292505"><span class="annot"><a href="#local-6989586621679292505"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span id="local-6989586621679292506"><span class="annot"><a href="#local-6989586621679292506"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679292507"><span class="annot"><a href="#local-6989586621679292507"><span class="hs-identifier hs-type">tdest</span></a></span></span><span> </span><span id="local-6989586621679292508"><span class="annot"><a href="#local-6989586621679292508"><span class="hs-identifier hs-type">act</span></a></span></span><span> </span><span id="local-6989586621679292509"><span class="annot"><a href="#local-6989586621679292509"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292503"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292504"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292505"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292506"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292507"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292508"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292509"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><span class="hs-comment">{- |
    Create a state-based stop condition, starting in the given initial state. The provided function should provide either 'Just' a new state to continue
    testing, or 'Nothing' to stop testing.
-}</span></span><span>
</span><span id="line-127"></span><span id="local-6989586621679292015"><span id="local-6989586621679292016"><span id="local-6989586621679292017"><span id="local-6989586621679292018"><span id="local-6989586621679292019"><span id="local-6989586621679292020"><span id="local-6989586621679292021"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#stopCondition"><span class="hs-identifier hs-type">stopCondition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679292015"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292015"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#AutIntrpr"><span class="hs-identifier hs-type">AutIntrpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292016"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292017"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292018"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292019"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292020"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292021"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292021"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292016"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292018"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679292015"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#StopCondition"><span class="hs-identifier hs-type">StopCondition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292016"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292017"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292018"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292019"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292020"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292021"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292015"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-128"></span><span id="stopCondition"><span class="annot"><span class="annottext">stopCondition :: forall s (m :: * -&gt; *) loc q t tdest act.
s
-&gt; (s
    -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe s))
-&gt; StopCondition m loc q t tdest act s
</span><a href="Lattest.Exec.StandardTestControllers.html#stopCondition"><span class="hs-identifier hs-var hs-var">stopCondition</span></a></span></span><span> </span><span id="local-6989586621679292514"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292514"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621679292515"><span class="annot"><span class="annottext">s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe s)
</span><a href="#local-6989586621679292515"><span class="hs-identifier hs-var">upd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="annottext">testControllerState :: s
</span><a href="Lattest.Exec.Testing.html#testControllerState"><span class="hs-identifier hs-var">testControllerState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292514"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="annottext">selectTest :: TestChoice () act =&gt;
s -&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Either ((), s) ())
</span><a href="Lattest.Exec.Testing.html#selectTest"><span class="hs-identifier hs-var">selectTest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292518"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292518"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">m q
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either ((), s) () -&gt; IO (Either ((), s) ())
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either ((), s) () -&gt; IO (Either ((), s) ()))
-&gt; Either ((), s) () -&gt; IO (Either ((), s) ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((), s) -&gt; Either ((), s) ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292518"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- no state change, continue testing</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">updateTestController :: s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Either s ())
</span><a href="Lattest.Exec.Testing.html#updateTestController"><span class="hs-identifier hs-var">updateTestController</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292519"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292519"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679292520"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292520"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span id="local-6989586621679292521"><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292521"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679292522"><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292522"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>        </span><span id="local-6989586621679292523"><span class="annot"><span class="annottext">Maybe s
</span><a href="#local-6989586621679292523"><span class="hs-identifier hs-var">maybeS'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe s)
</span><a href="#local-6989586621679292515"><span class="hs-identifier hs-var">upd</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292519"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292520"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292521"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292522"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe s
</span><a href="#local-6989586621679292523"><span class="hs-identifier hs-var">maybeS'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-134"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679292524"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292524"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either s () -&gt; IO (Either s ())
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either s () -&gt; IO (Either s ()))
-&gt; Either s () -&gt; IO (Either s ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; Either s ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292524"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-135"></span><span>            </span><span class="annot"><span class="annottext">Maybe s
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either s () -&gt; IO (Either s ())
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either s () -&gt; IO (Either s ()))
-&gt; Either s () -&gt; IO (Either s ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; Either s ()
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">handleTestClose :: s -&gt; IO ()
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; s -&gt; IO ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; s -&gt; IO ()) -&gt; IO () -&gt; s -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><span class="hs-comment">{- |
    Apply a stop condition: run the (first) test controller until it returns a result, or until the stop condition is reached. The selected inputs and returned result come from the test controller.
-}</span></span><span>
</span><span id="line-142"></span><span id="local-6989586621679292032"><span id="local-6989586621679292033"><span id="local-6989586621679292034"><span id="local-6989586621679292035"><span id="local-6989586621679292036"><span id="local-6989586621679292037"><span id="local-6989586621679292038"><span id="local-6989586621679292039"><span id="local-6989586621679292040"><span id="local-6989586621679292041"><span id="local-6989586621679292042"><span id="local-6989586621679292043"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#untilCondition"><span class="hs-identifier hs-type">untilCondition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292032"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292033"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292034"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292035"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292036"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292037"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292038"><span class="hs-identifier hs-type">state1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292039"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292040"><span class="hs-identifier hs-type">r1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292032"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292033"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292034"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292035"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292036"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292037"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292041"><span class="hs-identifier hs-type">state2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292042"><span class="hs-identifier hs-type">i2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292043"><span class="hs-identifier hs-type">r2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292032"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292033"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292034"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292035"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292036"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292037"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292038"><span class="hs-identifier hs-type">state1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679292041"><span class="hs-identifier hs-type">state2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679292039"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292040"><span class="hs-identifier hs-type">r1</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-143"></span><span id="untilCondition"><span class="annot"><span class="annottext">untilCondition :: forall (m :: * -&gt; *) loc q t tdest act state1 i1 r1 state2 i2 r2.
TestController m loc q t tdest act state1 i1 r1
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 r1
</span><a href="Lattest.Exec.StandardTestControllers.html#untilCondition"><span class="hs-identifier hs-var hs-var">untilCondition</span></a></span></span><span> </span><span id="local-6989586621679292530"><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292530"><span class="hs-identifier hs-var">controller</span></a></span></span><span> </span><span id="local-6989586621679292531"><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292531"><span class="hs-identifier hs-var">condition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">testControllerState :: (state1, state2)
</span><a href="Lattest.Exec.Testing.html#testControllerState"><span class="hs-identifier hs-var">testControllerState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1 -&gt; state1
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state
</span><a href="Lattest.Exec.Testing.html#testControllerState"><span class="hs-identifier hs-var">testControllerState</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292530"><span class="hs-identifier hs-var">controller</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2 -&gt; state2
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state
</span><a href="Lattest.Exec.Testing.html#testControllerState"><span class="hs-identifier hs-var">testControllerState</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292531"><span class="hs-identifier hs-var">condition</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">selectTest :: TestChoice i1 act =&gt;
(state1, state2)
-&gt; AutIntrpr m loc q t tdest act
-&gt; m q
-&gt; IO (Either (i1, (state1, state2)) r1)
</span><a href="Lattest.Exec.Testing.html#selectTest"><span class="hs-identifier hs-var">selectTest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292536"><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292536"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679292537"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292537"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span id="local-6989586621679292538"><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292538"><span class="hs-identifier hs-var">mq</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>        </span><span id="local-6989586621679292539"><span class="annot"><span class="annottext">Either (i1, state1) r1
</span><a href="#local-6989586621679292539"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
-&gt; TestChoice i1 act =&gt;
   state1
   -&gt; AutIntrpr m loc q t tdest act
   -&gt; m q
   -&gt; IO (Either (i1, state1) r1)
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r
-&gt; TestChoice i act =&gt;
   state
   -&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Either (i, state) r)
</span><a href="Lattest.Exec.Testing.html#selectTest"><span class="hs-identifier hs-var">selectTest</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292530"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(state1, state2) -&gt; state1
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292536"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292537"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292538"><span class="hs-identifier hs-var">mq</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">Either (i1, (state1, state2)) r1
-&gt; IO (Either (i1, (state1, state2)) r1)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (i1, (state1, state2)) r1
 -&gt; IO (Either (i1, (state1, state2)) r1))
-&gt; Either (i1, (state1, state2)) r1
-&gt; IO (Either (i1, (state1, state2)) r1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either (i1, state1) r1
</span><a href="#local-6989586621679292539"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-148"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679292541"><span class="annot"><span class="annottext">i1
</span><a href="#local-6989586621679292541"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679292542"><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292542"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i1, (state1, state2)) -&gt; Either (i1, (state1, state2)) r1
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i1
</span><a href="#local-6989586621679292541"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292542"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(state1, state2) -&gt; state2
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292536"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679292544"><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292544"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r1 -&gt; Either (i1, (state1, state2)) r1
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292544"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">updateTestController :: (state1, state2)
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either (state1, state2) r1)
</span><a href="Lattest.Exec.Testing.html#updateTestController"><span class="hs-identifier hs-var">updateTestController</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292545"><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292545"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679292546"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292546"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span id="local-6989586621679292547"><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292547"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679292548"><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292548"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>        </span><span id="local-6989586621679292549"><span class="annot"><span class="annottext">Either state1 r1
</span><a href="#local-6989586621679292549"><span class="hs-identifier hs-var">stateOrResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
-&gt; state1
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either state1 r1)
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r
-&gt; state
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either state r)
</span><a href="Lattest.Exec.Testing.html#updateTestController"><span class="hs-identifier hs-var">updateTestController</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292530"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(state1, state2) -&gt; state1
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292545"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292546"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292547"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292548"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span id="local-6989586621679292550"><span class="annot"><span class="annottext">Maybe state2
</span><a href="#local-6989586621679292550"><span class="hs-identifier hs-var">maybeCondState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
-&gt; state2
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Maybe state2)
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r
-&gt; state
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Maybe state)
</span><a href="#local-6989586621679292551"><span class="hs-identifier hs-var">updateStopCondition</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292531"><span class="hs-identifier hs-var">condition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(state1, state2) -&gt; state2
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292545"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292546"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292547"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292548"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either state1 r1
</span><a href="#local-6989586621679292549"><span class="hs-identifier hs-var">stateOrResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-154"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679292552"><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292552"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe state2
</span><a href="#local-6989586621679292550"><span class="hs-identifier hs-var">maybeCondState</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-155"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679292553"><span class="annot"><span class="annottext">state2
</span><a href="#local-6989586621679292553"><span class="hs-identifier hs-var">condState</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (state1, state2) r1 -&gt; IO (Either (state1, state2) r1)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (state1, state2) r1 -&gt; IO (Either (state1, state2) r1))
-&gt; Either (state1, state2) r1 -&gt; IO (Either (state1, state2) r1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2) -&gt; Either (state1, state2) r1
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292552"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">state2
</span><a href="#local-6989586621679292553"><span class="hs-identifier hs-var">condState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>                </span><span class="annot"><span class="annottext">Maybe state2
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r1 -&gt; Either (state1, state2) r1
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(r1 -&gt; Either (state1, state2) r1)
-&gt; IO r1 -&gt; IO (Either (state1, state2) r1)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1 -&gt; state1 -&gt; IO r1
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state -&gt; IO r
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292530"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292552"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-157"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679292554"><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292554"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (state1, state2) r1 -&gt; IO (Either (state1, state2) r1)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (state1, state2) r1 -&gt; IO (Either (state1, state2) r1))
-&gt; Either (state1, state2) r1 -&gt; IO (Either (state1, state2) r1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r1 -&gt; Either (state1, state2) r1
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292554"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><span class="annottext">handleTestClose :: (state1, state2) -&gt; IO r1
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292555"><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292555"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1 -&gt; state1 -&gt; IO r1
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state -&gt; IO r
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292530"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(state1, state2) -&gt; state1
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292555"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679292087"><span id="local-6989586621679292088"><span id="local-6989586621679292089"><span id="local-6989586621679292090"><span id="local-6989586621679292091"><span id="local-6989586621679292092"><span id="local-6989586621679292093"><span id="local-6989586621679292094"><span id="local-6989586621679292095"><span class="annot"><a href="#local-6989586621679292551"><span class="hs-identifier hs-type">updateStopCondition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292087"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292088"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292089"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292090"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292091"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292092"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292093"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292094"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292095"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292093"><span class="hs-identifier hs-type">state</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#AutIntrpr"><span class="hs-identifier hs-type">AutIntrpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292087"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292088"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292089"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292090"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292091"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292092"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292092"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292087"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292089"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679292093"><span class="hs-identifier hs-type">state</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679292551"><span class="annot"><span class="annottext">updateStopCondition :: forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r
-&gt; state
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Maybe state)
</span><a href="#local-6989586621679292551"><span class="hs-identifier hs-var hs-var">updateStopCondition</span></a></span></span><span> </span><span id="local-6989586621679292558"><span class="annot"><span class="annottext">TestController m loc q t tdest act state i r
</span><a href="#local-6989586621679292558"><span class="hs-identifier hs-var">condition</span></a></span></span><span> </span><span id="local-6989586621679292559"><span class="annot"><span class="annottext">state
</span><a href="#local-6989586621679292559"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621679292560"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292560"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span id="local-6989586621679292561"><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292561"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679292562"><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292562"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state i r
-&gt; state
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either state r)
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r
-&gt; state
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either state r)
</span><a href="Lattest.Exec.Testing.html#updateTestController"><span class="hs-identifier hs-var">updateTestController</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state i r
</span><a href="#local-6989586621679292558"><span class="hs-identifier hs-var">condition</span></a></span><span> </span><span class="annot"><span class="annottext">state
</span><a href="#local-6989586621679292559"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292560"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292561"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292562"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either state r)
-&gt; (Either state r -&gt; IO (Maybe state)) -&gt; IO (Maybe state)
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Maybe state -&gt; IO (Maybe state)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe state -&gt; IO (Maybe state))
-&gt; (Either state r -&gt; Maybe state)
-&gt; Either state r
-&gt; IO (Maybe state)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either state r -&gt; Maybe state
forall a b. Either a b -&gt; Maybe a
</span><span class="hs-identifier hs-var">leftToMaybe</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><span class="hs-comment">{- |
    Observe a fixed number of actions, and then stop testing.
    
    Note: since stop conditions only decide whether to stop testing after observing an action, the minimum number of actions to observe is 1.
-}</span></span><span>
</span><span id="line-170"></span><span id="local-6989586621679292116"><span id="local-6989586621679292117"><span id="local-6989586621679292118"><span id="local-6989586621679292119"><span id="local-6989586621679292120"><span id="local-6989586621679292121"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#stopAfterSteps"><span class="hs-identifier hs-type">stopAfterSteps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#StopCondition"><span class="hs-identifier hs-type">StopCondition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292116"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292117"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292118"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292119"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292120"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292121"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span></span></span></span></span><span>
</span><span id="line-171"></span><span id="stopAfterSteps"><span class="annot"><span class="annottext">stopAfterSteps :: forall (m :: * -&gt; *) loc q t tdest act.
Int -&gt; StopCondition m loc q t tdest act Int
</span><a href="Lattest.Exec.StandardTestControllers.html#stopAfterSteps"><span class="hs-identifier hs-var hs-var">stopAfterSteps</span></a></span></span><span> </span><span id="local-6989586621679292570"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679292570"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (Int
    -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe Int))
-&gt; StopCondition m loc q t tdest act Int
forall s (m :: * -&gt; *) loc q t tdest act.
s
-&gt; (s
    -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe s))
-&gt; StopCondition m loc q t tdest act s
</span><a href="Lattest.Exec.StandardTestControllers.html#stopCondition"><span class="hs-identifier hs-var">stopCondition</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679292570"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679292571"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679292571"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">act
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">m q
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; IO (Maybe Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; IO (Maybe Int)) -&gt; Maybe Int -&gt; IO (Maybe Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679292571"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679292571"><span class="hs-identifier hs-var">n'</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><span class="hs-comment">{- |
    'TestObserver's are only concerned with returning a result after testing. They do not select inputs or decide whether to continue testing.
-}</span></span><span>
</span><span id="line-176"></span><span class="hs-keyword">type</span><span> </span><span id="TestObserver"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestObserver"><span class="hs-identifier hs-var">TestObserver</span></a></span></span><span> </span><span id="local-6989586621679292573"><span class="annot"><a href="#local-6989586621679292573"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679292574"><span class="annot"><a href="#local-6989586621679292574"><span class="hs-identifier hs-type">loc</span></a></span></span><span> </span><span id="local-6989586621679292575"><span class="annot"><a href="#local-6989586621679292575"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span id="local-6989586621679292576"><span class="annot"><a href="#local-6989586621679292576"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679292577"><span class="annot"><a href="#local-6989586621679292577"><span class="hs-identifier hs-type">tdest</span></a></span></span><span> </span><span id="local-6989586621679292578"><span class="annot"><a href="#local-6989586621679292578"><span class="hs-identifier hs-type">act</span></a></span></span><span> </span><span id="local-6989586621679292579"><span class="annot"><a href="#local-6989586621679292579"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679292580"><span class="annot"><a href="#local-6989586621679292580"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292573"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292574"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292575"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292576"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292577"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292578"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292579"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679292580"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="annot"><span class="hs-comment">{- |
    Create a 'TestObserver'.
-}</span></span><span>
</span><span id="line-181"></span><span id="local-6989586621679292129"><span id="local-6989586621679292130"><span id="local-6989586621679292131"><span id="local-6989586621679292132"><span id="local-6989586621679292133"><span id="local-6989586621679292134"><span id="local-6989586621679292135"><span id="local-6989586621679292136"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#observer"><span class="hs-identifier hs-type">observer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679292129"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292129"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#AutIntrpr"><span class="hs-identifier hs-type">AutIntrpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292131"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292132"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292133"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292134"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292135"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292135"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292132"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679292129"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292129"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679292136"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestObserver"><span class="hs-identifier hs-type">TestObserver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292131"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292132"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292133"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292134"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292135"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292129"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292136"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-182"></span><span id="observer"><span class="annot"><span class="annottext">observer :: forall s (m :: * -&gt; *) loc q t tdest act r.
s
-&gt; (s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s)
-&gt; (s -&gt; IO r)
-&gt; TestObserver m loc q t tdest act s r
</span><a href="Lattest.Exec.StandardTestControllers.html#observer"><span class="hs-identifier hs-var hs-var">observer</span></a></span></span><span> </span><span id="local-6989586621679292582"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292582"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621679292583"><span class="annot"><span class="annottext">s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s
</span><a href="#local-6989586621679292583"><span class="hs-identifier hs-var">upd</span></a></span></span><span> </span><span id="local-6989586621679292584"><span class="annot"><span class="annottext">s -&gt; IO r
</span><a href="#local-6989586621679292584"><span class="hs-identifier hs-var">finish</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">testControllerState :: s
</span><a href="Lattest.Exec.Testing.html#testControllerState"><span class="hs-identifier hs-var">testControllerState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292582"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><span class="annottext">selectTest :: TestChoice () act =&gt;
s -&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Either ((), s) r)
</span><a href="Lattest.Exec.Testing.html#selectTest"><span class="hs-identifier hs-var">selectTest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292587"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292587"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">m q
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either ((), s) r -&gt; IO (Either ((), s) r)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either ((), s) r -&gt; IO (Either ((), s) r))
-&gt; Either ((), s) r -&gt; IO (Either ((), s) r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((), s) -&gt; Either ((), s) r
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292587"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- no state change, continue testing</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><span class="annottext">updateTestController :: s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Either s r)
</span><a href="Lattest.Exec.Testing.html#updateTestController"><span class="hs-identifier hs-var">updateTestController</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292588"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292588"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679292589"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292589"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span id="local-6989586621679292590"><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292590"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679292591"><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292591"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s -&gt; Either s r
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(s -&gt; Either s r) -&gt; IO s -&gt; IO (Either s r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s
</span><a href="#local-6989586621679292583"><span class="hs-identifier hs-var">upd</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292588"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292589"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292590"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292591"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="annottext">handleTestClose :: s -&gt; IO r
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; IO r
</span><a href="#local-6989586621679292584"><span class="hs-identifier hs-var">finish</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><span class="hs-comment">{- |
    Apply an observer: Use the (former) test controller, but also returning the result of the (latter) observer. Combine the two results using the given function.
-}</span></span><span>
</span><span id="line-192"></span><span id="local-6989586621679292146"><span id="local-6989586621679292147"><span id="local-6989586621679292148"><span id="local-6989586621679292149"><span id="local-6989586621679292150"><span id="local-6989586621679292151"><span id="local-6989586621679292152"><span id="local-6989586621679292153"><span id="local-6989586621679292154"><span id="local-6989586621679292155"><span id="local-6989586621679292156"><span id="local-6989586621679292157"><span id="local-6989586621679292158"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#andObservingWith"><span class="hs-identifier hs-type">andObservingWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292146"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292147"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292148"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292149"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292150"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292151"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292152"><span class="hs-identifier hs-type">state1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292153"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292154"><span class="hs-identifier hs-type">r1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292154"><span class="hs-identifier hs-type">r1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292155"><span class="hs-identifier hs-type">r2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292156"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292146"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292147"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292148"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292149"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292150"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292151"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292157"><span class="hs-identifier hs-type">state2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292158"><span class="hs-identifier hs-type">i2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292155"><span class="hs-identifier hs-type">r2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292146"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292147"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292148"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292149"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292150"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292151"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292152"><span class="hs-identifier hs-type">state1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679292157"><span class="hs-identifier hs-type">state2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679292153"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292156"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-193"></span><span id="andObservingWith"><span class="annot"><span class="annottext">andObservingWith :: forall (m :: * -&gt; *) loc q t tdest act state1 i1 r1 r2 r state2 i2.
TestController m loc q t tdest act state1 i1 r1
-&gt; (r1 -&gt; r2 -&gt; r)
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 r
</span><a href="Lattest.Exec.StandardTestControllers.html#andObservingWith"><span class="hs-identifier hs-var hs-var">andObservingWith</span></a></span></span><span> </span><span id="local-6989586621679292603"><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292603"><span class="hs-identifier hs-var">controller</span></a></span></span><span> </span><span id="local-6989586621679292604"><span class="annot"><span class="annottext">r1 -&gt; r2 -&gt; r
</span><a href="#local-6989586621679292604"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679292605"><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292605"><span class="hs-identifier hs-var">obs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">testControllerState :: (state1, state2)
</span><a href="Lattest.Exec.Testing.html#testControllerState"><span class="hs-identifier hs-var">testControllerState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1 -&gt; state1
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state
</span><a href="Lattest.Exec.Testing.html#testControllerState"><span class="hs-identifier hs-var">testControllerState</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292603"><span class="hs-identifier hs-var">controller</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2 -&gt; state2
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state
</span><a href="Lattest.Exec.Testing.html#testControllerState"><span class="hs-identifier hs-var">testControllerState</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292605"><span class="hs-identifier hs-var">obs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">selectTest :: TestChoice i1 act =&gt;
(state1, state2)
-&gt; AutIntrpr m loc q t tdest act
-&gt; m q
-&gt; IO (Either (i1, (state1, state2)) r)
</span><a href="Lattest.Exec.Testing.html#selectTest"><span class="hs-identifier hs-var">selectTest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292612"><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292612"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679292613"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292613"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span id="local-6989586621679292614"><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292614"><span class="hs-identifier hs-var">mq</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>        </span><span id="local-6989586621679292615"><span class="annot"><span class="annottext">Either (i1, state1) r1
</span><a href="#local-6989586621679292615"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
-&gt; TestChoice i1 act =&gt;
   state1
   -&gt; AutIntrpr m loc q t tdest act
   -&gt; m q
   -&gt; IO (Either (i1, state1) r1)
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r
-&gt; TestChoice i act =&gt;
   state
   -&gt; AutIntrpr m loc q t tdest act -&gt; m q -&gt; IO (Either (i, state) r)
</span><a href="Lattest.Exec.Testing.html#selectTest"><span class="hs-identifier hs-var">selectTest</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292603"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(state1, state2) -&gt; state1
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292612"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292613"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292614"><span class="hs-identifier hs-var">mq</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either (i1, state1) r1
</span><a href="#local-6989586621679292615"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679292616"><span class="annot"><span class="annottext">i1
</span><a href="#local-6989586621679292616"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679292617"><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292617"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (i1, (state1, state2)) r
-&gt; IO (Either (i1, (state1, state2)) r)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (i1, (state1, state2)) r
 -&gt; IO (Either (i1, (state1, state2)) r))
-&gt; Either (i1, (state1, state2)) r
-&gt; IO (Either (i1, (state1, state2)) r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(i1, (state1, state2)) -&gt; Either (i1, (state1, state2)) r
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i1
</span><a href="#local-6989586621679292616"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292617"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(state1, state2) -&gt; state2
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292612"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679292618"><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292618"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-200"></span><span>                </span><span id="local-6989586621679292619"><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292619"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2 -&gt; state2 -&gt; IO r2
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state -&gt; IO r
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292605"><span class="hs-identifier hs-var">obs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(state1, state2) -&gt; state2
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292612"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>                </span><span class="annot"><span class="annottext">Either (i1, (state1, state2)) r
-&gt; IO (Either (i1, (state1, state2)) r)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (i1, (state1, state2)) r
 -&gt; IO (Either (i1, (state1, state2)) r))
-&gt; Either (i1, (state1, state2)) r
-&gt; IO (Either (i1, (state1, state2)) r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Either (i1, (state1, state2)) r
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Either (i1, (state1, state2)) r)
-&gt; r -&gt; Either (i1, (state1, state2)) r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r1 -&gt; r2 -&gt; r
</span><a href="#local-6989586621679292604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292618"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292619"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">updateTestController :: (state1, state2)
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either (state1, state2) r)
</span><a href="Lattest.Exec.Testing.html#updateTestController"><span class="hs-identifier hs-var">updateTestController</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679292620"><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292620"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679292621"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292621"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span id="local-6989586621679292622"><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292622"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679292623"><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292623"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>        </span><span id="local-6989586621679292624"><span class="annot"><span class="annottext">Either state1 r1
</span><a href="#local-6989586621679292624"><span class="hs-identifier hs-var">stateOrResult1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
-&gt; state1
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either state1 r1)
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r
-&gt; state
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either state r)
</span><a href="Lattest.Exec.Testing.html#updateTestController"><span class="hs-identifier hs-var">updateTestController</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292603"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(state1, state2) -&gt; state1
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292620"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292621"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292622"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292623"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span id="local-6989586621679292625"><span class="annot"><span class="annottext">Either state2 r2
</span><a href="#local-6989586621679292625"><span class="hs-identifier hs-var">stateOrResult2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
-&gt; state2
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either state2 r2)
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r
-&gt; state
-&gt; AutIntrpr m loc q t tdest act
-&gt; act
-&gt; m q
-&gt; IO (Either state r)
</span><a href="Lattest.Exec.Testing.html#updateTestController"><span class="hs-identifier hs-var">updateTestController</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292605"><span class="hs-identifier hs-var">obs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(state1, state2) -&gt; state2
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2)
</span><a href="#local-6989586621679292620"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292621"><span class="hs-identifier hs-var">aut</span></a></span><span> </span><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292622"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292623"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either state1 r1
</span><a href="#local-6989586621679292624"><span class="hs-identifier hs-var">stateOrResult1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679292626"><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292626"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either state2 r2
</span><a href="#local-6989586621679292625"><span class="hs-identifier hs-var">stateOrResult2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679292627"><span class="annot"><span class="annottext">state2
</span><a href="#local-6989586621679292627"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (state1, state2) r -&gt; IO (Either (state1, state2) r)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (state1, state2) r -&gt; IO (Either (state1, state2) r))
-&gt; Either (state1, state2) r -&gt; IO (Either (state1, state2) r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(state1, state2) -&gt; Either (state1, state2) r
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292626"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">state2
</span><a href="#local-6989586621679292627"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679292628"><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292628"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-209"></span><span>                    </span><span id="local-6989586621679292629"><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292629"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1 -&gt; state1 -&gt; IO r1
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state -&gt; IO r
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292603"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292626"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-210"></span><span>                    </span><span class="annot"><span class="annottext">Either (state1, state2) r -&gt; IO (Either (state1, state2) r)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (state1, state2) r -&gt; IO (Either (state1, state2) r))
-&gt; Either (state1, state2) r -&gt; IO (Either (state1, state2) r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Either (state1, state2) r
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Either (state1, state2) r) -&gt; r -&gt; Either (state1, state2) r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r1 -&gt; r2 -&gt; r
</span><a href="#local-6989586621679292604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292629"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292628"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-211"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679292630"><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292630"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either state2 r2
</span><a href="#local-6989586621679292625"><span class="hs-identifier hs-var">stateOrResult2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-212"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679292631"><span class="annot"><span class="annottext">state2
</span><a href="#local-6989586621679292631"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>                    </span><span id="local-6989586621679292632"><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292632"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2 -&gt; state2 -&gt; IO r2
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state -&gt; IO r
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292605"><span class="hs-identifier hs-var">obs</span></a></span><span> </span><span class="annot"><span class="annottext">state2
</span><a href="#local-6989586621679292631"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-214"></span><span>                    </span><span class="annot"><span class="annottext">Either (state1, state2) r -&gt; IO (Either (state1, state2) r)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (state1, state2) r -&gt; IO (Either (state1, state2) r))
-&gt; Either (state1, state2) r -&gt; IO (Either (state1, state2) r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Either (state1, state2) r
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Either (state1, state2) r) -&gt; r -&gt; Either (state1, state2) r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r1 -&gt; r2 -&gt; r
</span><a href="#local-6989586621679292604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292630"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292632"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-215"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679292633"><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292633"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (state1, state2) r -&gt; IO (Either (state1, state2) r)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either (state1, state2) r -&gt; IO (Either (state1, state2) r))
-&gt; Either (state1, state2) r -&gt; IO (Either (state1, state2) r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; Either (state1, state2) r
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Either (state1, state2) r) -&gt; r -&gt; Either (state1, state2) r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r1 -&gt; r2 -&gt; r
</span><a href="#local-6989586621679292604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292630"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292633"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">handleTestClose :: (state1, state2) -&gt; IO r
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679292634"><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292634"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679292635"><span class="annot"><span class="annottext">state2
</span><a href="#local-6989586621679292635"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-217"></span><span>        </span><span id="local-6989586621679292636"><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292636"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1 -&gt; state1 -&gt; IO r1
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state -&gt; IO r
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292603"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="annot"><span class="annottext">state1
</span><a href="#local-6989586621679292634"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span id="local-6989586621679292637"><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292637"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2 -&gt; state2 -&gt; IO r2
forall (m :: * -&gt; *) loc q t tdest act state i r.
TestController m loc q t tdest act state i r -&gt; state -&gt; IO r
</span><a href="Lattest.Exec.Testing.html#handleTestClose"><span class="hs-identifier hs-var">handleTestClose</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292605"><span class="hs-identifier hs-var">obs</span></a></span><span> </span><span class="annot"><span class="annottext">state2
</span><a href="#local-6989586621679292635"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><span class="annottext">r -&gt; IO r
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; IO r) -&gt; r -&gt; IO r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r1 -&gt; r2 -&gt; r
</span><a href="#local-6989586621679292604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292636"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292637"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><span class="hs-comment">{- |
    Apply an observer: use the (former) test controller, but also returning the result of the (latter) observer in a tuple.
-}</span></span><span>
</span><span id="line-225"></span><span id="local-6989586621679292172"><span id="local-6989586621679292173"><span id="local-6989586621679292174"><span id="local-6989586621679292175"><span id="local-6989586621679292176"><span id="local-6989586621679292177"><span id="local-6989586621679292178"><span id="local-6989586621679292179"><span id="local-6989586621679292180"><span id="local-6989586621679292181"><span id="local-6989586621679292182"><span id="local-6989586621679292183"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#andObserving"><span class="hs-identifier hs-type">andObserving</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292172"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292173"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292174"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292175"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292176"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292177"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292178"><span class="hs-identifier hs-type">state1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292179"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292180"><span class="hs-identifier hs-type">r1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292172"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292173"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292174"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292175"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292176"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292177"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292181"><span class="hs-identifier hs-type">state2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292182"><span class="hs-identifier hs-type">i2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292183"><span class="hs-identifier hs-type">r2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292172"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292173"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292174"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292175"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292176"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292177"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292178"><span class="hs-identifier hs-type">state1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679292181"><span class="hs-identifier hs-type">state2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679292179"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292180"><span class="hs-identifier hs-type">r1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679292183"><span class="hs-identifier hs-type">r2</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-226"></span><span id="andObserving"><span class="annot"><span class="annottext">andObserving :: forall (m :: * -&gt; *) loc q t tdest act state1 i1 r1 state2 i2 r2.
TestController m loc q t tdest act state1 i1 r1
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 (r1, r2)
</span><a href="Lattest.Exec.StandardTestControllers.html#andObserving"><span class="hs-identifier hs-var hs-var">andObserving</span></a></span></span><span> </span><span id="local-6989586621679292638"><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292638"><span class="hs-identifier hs-var">controller</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
-&gt; (r1 -&gt; r2 -&gt; (r1, r2))
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 (r1, r2)
forall (m :: * -&gt; *) loc q t tdest act state1 i1 r1 r2 r state2 i2.
TestController m loc q t tdest act state1 i1 r1
-&gt; (r1 -&gt; r2 -&gt; r)
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 r
</span><a href="Lattest.Exec.StandardTestControllers.html#andObservingWith"><span class="hs-identifier hs-var">andObservingWith</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292638"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><span class="hs-comment">{- |
    Apply an observer: use the (former) test controller, but only return the result of the (latter) observer.
-}</span></span><span>
</span><span id="line-231"></span><span id="local-6989586621679292196"><span id="local-6989586621679292197"><span id="local-6989586621679292198"><span id="local-6989586621679292199"><span id="local-6989586621679292200"><span id="local-6989586621679292201"><span id="local-6989586621679292202"><span id="local-6989586621679292203"><span id="local-6989586621679292204"><span id="local-6989586621679292205"><span id="local-6989586621679292206"><span id="local-6989586621679292207"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#observingOnly"><span class="hs-identifier hs-type">observingOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292196"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292197"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292198"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292199"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292200"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292201"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292202"><span class="hs-identifier hs-type">state1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292203"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292204"><span class="hs-identifier hs-type">r1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292196"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292197"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292198"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292199"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292200"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292201"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292205"><span class="hs-identifier hs-type">state2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292206"><span class="hs-identifier hs-type">i2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292207"><span class="hs-identifier hs-type">r2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292196"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292197"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292198"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292199"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292200"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292201"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292202"><span class="hs-identifier hs-type">state1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679292205"><span class="hs-identifier hs-type">state2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679292203"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292207"><span class="hs-identifier hs-type">r2</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-232"></span><span id="observingOnly"><span class="annot"><span class="annottext">observingOnly :: forall (m :: * -&gt; *) loc q t tdest act state1 i1 r1 state2 i2 r2.
TestController m loc q t tdest act state1 i1 r1
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 r2
</span><a href="Lattest.Exec.StandardTestControllers.html#observingOnly"><span class="hs-identifier hs-var hs-var">observingOnly</span></a></span></span><span> </span><span id="local-6989586621679292639"><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292639"><span class="hs-identifier hs-var">controller</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
-&gt; (r1 -&gt; r2 -&gt; r2)
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 r2
forall (m :: * -&gt; *) loc q t tdest act state1 i1 r1 r2 r state2 i2.
TestController m loc q t tdest act state1 i1 r1
-&gt; (r1 -&gt; r2 -&gt; r)
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 r
</span><a href="Lattest.Exec.StandardTestControllers.html#andObservingWith"><span class="hs-identifier hs-var">andObservingWith</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292639"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679292640"><span class="annot"><span class="annottext">r1
</span><a href="#local-6989586621679292640"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621679292641"><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292641"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r2
</span><a href="#local-6989586621679292641"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="annot"><span class="hs-comment">{- |
    A 'TestObserver' that returns the trace of all observed actions
-}</span></span><span>
</span><span id="line-237"></span><span id="local-6989586621679292220"><span id="local-6989586621679292221"><span id="local-6989586621679292222"><span id="local-6989586621679292223"><span id="local-6989586621679292224"><span id="local-6989586621679292225"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#traceObserver"><span class="hs-identifier hs-type">traceObserver</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestObserver"><span class="hs-identifier hs-type">TestObserver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292220"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292221"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292222"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292223"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292224"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292225"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679292225"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679292225"><span class="hs-identifier hs-type">act</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span><span>
</span><span id="line-238"></span><span id="traceObserver"><span class="annot"><span class="annottext">traceObserver :: forall (m :: * -&gt; *) loc q t tdest act.
TestObserver m loc q t tdest act [act] [act]
</span><a href="Lattest.Exec.StandardTestControllers.html#traceObserver"><span class="hs-identifier hs-var hs-var">traceObserver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[act]
-&gt; ([act]
    -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO [act])
-&gt; ([act] -&gt; IO [act])
-&gt; TestObserver m loc q t tdest act [act] [act]
forall s (m :: * -&gt; *) loc q t tdest act r.
s
-&gt; (s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s)
-&gt; (s -&gt; IO r)
-&gt; TestObserver m loc q t tdest act s r
</span><a href="Lattest.Exec.StandardTestControllers.html#observer"><span class="hs-identifier hs-var">observer</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679292645"><span class="annot"><span class="annottext">[act]
</span><a href="#local-6989586621679292645"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679292646"><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292646"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="annot"><span class="annottext">m q
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[act] -&gt; IO [act]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([act] -&gt; IO [act]) -&gt; [act] -&gt; IO [act]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292646"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">act -&gt; [act] -&gt; [act]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[act]
</span><a href="#local-6989586621679292645"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[act] -&gt; IO [act]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([act] -&gt; IO [act]) -&gt; ([act] -&gt; [act]) -&gt; [act] -&gt; IO [act]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[act] -&gt; [act]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- FIXME get rid of the Maybe</span><span>
</span><span id="line-241"></span><span class="annot"><span class="hs-comment">{- |
    A 'TestObserver' that returns the last state configuration of the specification model. This may be a conclusive state. For example,
    during a failed test, this observer returns 'forbidden'.
-}</span></span><span>
</span><span id="line-245"></span><span id="local-6989586621679292234"><span id="local-6989586621679292235"><span id="local-6989586621679292236"><span id="local-6989586621679292237"><span id="local-6989586621679292238"><span id="local-6989586621679292239"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#stateObserver"><span class="hs-identifier hs-type">stateObserver</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestObserver"><span class="hs-identifier hs-type">TestObserver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292234"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292235"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292236"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292237"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292238"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292239"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292234"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292236"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292234"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292236"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-246"></span><span id="stateObserver"><span class="annot"><span class="annottext">stateObserver :: forall (m :: * -&gt; *) loc q t tdest act.
TestObserver m loc q t tdest act (Maybe (m q)) (Maybe (m q))
</span><a href="Lattest.Exec.StandardTestControllers.html#stateObserver"><span class="hs-identifier hs-var hs-var">stateObserver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (m q)
-&gt; (Maybe (m q)
    -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe (m q)))
-&gt; (Maybe (m q) -&gt; IO (Maybe (m q)))
-&gt; TestObserver m loc q t tdest act (Maybe (m q)) (Maybe (m q))
forall s (m :: * -&gt; *) loc q t tdest act r.
s
-&gt; (s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s)
-&gt; (s -&gt; IO r)
-&gt; TestObserver m loc q t tdest act s r
</span><a href="Lattest.Exec.StandardTestControllers.html#observer"><span class="hs-identifier hs-var">observer</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (m q)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Maybe (m q)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679292650"><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292650"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span class="annot"><span class="annottext">act
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">m q
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (m q) -&gt; IO (Maybe (m q))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (m q) -&gt; IO (Maybe (m q)))
-&gt; Maybe (m q) -&gt; IO (Maybe (m q))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m q -&gt; Maybe (m q)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act -&gt; m q
forall {k} (m :: * -&gt; *) loc q t tdest (act :: k).
AutIntrpr m loc q t tdest act -&gt; m q
</span><a href="Lattest.Model.Automaton.html#stateConf"><span class="hs-identifier hs-var">stateConf</span></a></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><a href="#local-6989586621679292650"><span class="hs-identifier hs-var">aut</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (m q) -&gt; IO (Maybe (m q))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><span class="hs-comment">{- |
    A 'TestObserver' that returns the last inconclusive state configuration of the specification model. For example, during a failing test,
    this observer returns the last state before the failure.
    
-}</span></span><span>
</span><span id="line-253"></span><span id="local-6989586621679292253"><span id="local-6989586621679292254"><span id="local-6989586621679292255"><span id="local-6989586621679292256"><span id="local-6989586621679292257"><span id="local-6989586621679292258"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#inconclusiveStateObserver"><span class="hs-identifier hs-type">inconclusiveStateObserver</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lattest.Model.BoundedMonad.html#BoundedConfiguration"><span class="hs-identifier hs-type">BoundedConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292253"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestObserver"><span class="hs-identifier hs-type">TestObserver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292253"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292254"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292255"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292256"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292257"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292258"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292253"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292255"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292253"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292255"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-254"></span><span id="inconclusiveStateObserver"><span class="annot"><span class="annottext">inconclusiveStateObserver :: forall (m :: * -&gt; *) loc q t tdest act.
BoundedConfiguration m =&gt;
TestObserver m loc q t tdest act (Maybe (m q)) (Maybe (m q))
</span><a href="Lattest.Exec.StandardTestControllers.html#inconclusiveStateObserver"><span class="hs-identifier hs-var hs-var">inconclusiveStateObserver</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (m q)
-&gt; (Maybe (m q)
    -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe (m q)))
-&gt; (Maybe (m q) -&gt; IO (Maybe (m q)))
-&gt; TestObserver m loc q t tdest act (Maybe (m q)) (Maybe (m q))
forall s (m :: * -&gt; *) loc q t tdest act r.
s
-&gt; (s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s)
-&gt; (s -&gt; IO r)
-&gt; TestObserver m loc q t tdest act s r
</span><a href="Lattest.Exec.StandardTestControllers.html#observer"><span class="hs-identifier hs-var">observer</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (m q)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (m q)
-&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO (Maybe (m q))
forall {k} {m :: * -&gt; *} {m :: * -&gt; *} {p} {loc} {t} {t} {tdest}
       {act :: k} {p}.
(Monad m, BoundedConfiguration m) =&gt;
p -&gt; AutIntrpr m loc t t tdest act -&gt; p -&gt; m t -&gt; m (Maybe (m t))
</span><a href="#local-6989586621679292655"><span class="hs-identifier hs-var">makeSelection</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (m q) -&gt; IO (Maybe (m q))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679292655"><span class="annot"><span class="annottext">makeSelection :: p -&gt; AutIntrpr m loc t t tdest act -&gt; p -&gt; m t -&gt; m (Maybe (m t))
</span><a href="#local-6989586621679292655"><span class="hs-identifier hs-var hs-var">makeSelection</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679292664"><span class="annot"><span class="annottext">AutIntrpr m loc t t tdest act
</span><a href="#local-6989586621679292664"><span class="hs-identifier hs-var">aut</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679292665"><span class="annot"><span class="annottext">m t
</span><a href="#local-6989586621679292665"><span class="hs-identifier hs-var">mq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-257"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679292666"><span class="annot"><span class="annottext">mq' :: m t
</span><a href="#local-6989586621679292666"><span class="hs-identifier hs-var hs-var">mq'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc t t tdest act -&gt; m t
forall {k} (m :: * -&gt; *) loc q t tdest (act :: k).
AutIntrpr m loc q t tdest act -&gt; m q
</span><a href="Lattest.Model.Automaton.html#stateConf"><span class="hs-identifier hs-var">stateConf</span></a></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc t t tdest act
</span><a href="#local-6989586621679292664"><span class="hs-identifier hs-var">aut</span></a></span><span>
</span><span id="line-258"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Maybe (m t) -&gt; m (Maybe (m t))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (m t) -&gt; m (Maybe (m t))) -&gt; Maybe (m t) -&gt; m (Maybe (m t))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m t -&gt; Maybe (m t)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(m t -&gt; Maybe (m t)) -&gt; m t -&gt; Maybe (m t)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">m t -&gt; Bool
forall {k} (m :: k -&gt; *) (t :: k).
BoundedConfiguration m =&gt;
m t -&gt; Bool
</span><a href="Lattest.Model.BoundedMonad.html#isConclusive"><span class="hs-identifier hs-var">isConclusive</span></a></span><span> </span><span class="annot"><span class="annottext">m t
</span><a href="#local-6989586621679292666"><span class="hs-identifier hs-var">mq'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m t
</span><a href="#local-6989586621679292665"><span class="hs-identifier hs-var">mq</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">m t
</span><a href="#local-6989586621679292666"><span class="hs-identifier hs-var">mq'</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><span class="hs-comment">{- |
    'TestSideEffect's perform side effects during testing, but have no impact on the testing itself, nor on the result.
-}</span></span><span>
</span><span id="line-263"></span><span class="hs-keyword">type</span><span> </span><span id="TestSideEffect"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSideEffect"><span class="hs-identifier hs-var">TestSideEffect</span></a></span></span><span> </span><span id="local-6989586621679292667"><span class="annot"><a href="#local-6989586621679292667"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679292668"><span class="annot"><a href="#local-6989586621679292668"><span class="hs-identifier hs-type">loc</span></a></span></span><span> </span><span id="local-6989586621679292669"><span class="annot"><a href="#local-6989586621679292669"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span id="local-6989586621679292670"><span class="annot"><a href="#local-6989586621679292670"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679292671"><span class="annot"><a href="#local-6989586621679292671"><span class="hs-identifier hs-type">tdest</span></a></span></span><span> </span><span id="local-6989586621679292672"><span class="annot"><a href="#local-6989586621679292672"><span class="hs-identifier hs-type">act</span></a></span></span><span> </span><span id="local-6989586621679292673"><span class="annot"><a href="#local-6989586621679292673"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292667"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292668"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292669"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292670"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292671"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292672"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292673"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><span class="hs-comment">{- |
    Apply a side effect: Use the (former) test controller, but also perform the side effect of the (latter) observer.
-}</span></span><span>
</span><span id="line-268"></span><span id="local-6989586621679292674"><span id="local-6989586621679292675"><span id="local-6989586621679292676"><span id="local-6989586621679292677"><span id="local-6989586621679292678"><span id="local-6989586621679292679"><span id="local-6989586621679292680"><span id="local-6989586621679292681"><span id="local-6989586621679292682"><span id="local-6989586621679292683"><span id="local-6989586621679292684"><span id="local-6989586621679292685"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#withSideEffect"><span class="hs-identifier hs-type">withSideEffect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292674"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292675"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292676"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292677"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292678"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292679"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292680"><span class="hs-identifier hs-type">state1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292681"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292682"><span class="hs-identifier hs-type">r1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292674"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292675"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292676"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292677"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292678"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292679"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292683"><span class="hs-identifier hs-type">state2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292684"><span class="hs-identifier hs-type">i2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292685"><span class="hs-identifier hs-type">r2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.Testing.html#TestController"><span class="hs-identifier hs-type">TestController</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292674"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292675"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292676"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292677"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292678"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292679"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292680"><span class="hs-identifier hs-type">state1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679292683"><span class="hs-identifier hs-type">state2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679292681"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292682"><span class="hs-identifier hs-type">r1</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-269"></span><span id="withSideEffect"><span class="annot"><span class="annottext">withSideEffect :: forall (m :: * -&gt; *) loc q t tdest act state1 i1 r1 state2 i2 r2.
TestController m loc q t tdest act state1 i1 r1
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 r1
</span><a href="Lattest.Exec.StandardTestControllers.html#withSideEffect"><span class="hs-identifier hs-var hs-var">withSideEffect</span></a></span></span><span> </span><span id="local-6989586621679292686"><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292686"><span class="hs-identifier hs-var">controller</span></a></span></span><span> </span><span id="local-6989586621679292687"><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292687"><span class="hs-identifier hs-var">sideEffect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
-&gt; (r1 -&gt; r2 -&gt; r1)
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 r1
forall (m :: * -&gt; *) loc q t tdest act state1 i1 r1 r2 r state2 i2.
TestController m loc q t tdest act state1 i1 r1
-&gt; (r1 -&gt; r2 -&gt; r)
-&gt; TestController m loc q t tdest act state2 i2 r2
-&gt; TestController m loc q t tdest act (state1, state2) i1 r
</span><a href="Lattest.Exec.StandardTestControllers.html#andObservingWith"><span class="hs-identifier hs-var">andObservingWith</span></a></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state1 i1 r1
</span><a href="#local-6989586621679292686"><span class="hs-identifier hs-var">controller</span></a></span><span> </span><span class="annot"><span class="annottext">r1 -&gt; r2 -&gt; r1
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">TestController m loc q t tdest act state2 i2 r2
</span><a href="#local-6989586621679292687"><span class="hs-identifier hs-var">sideEffect</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="annot"><span class="hs-comment">{- |
    Create a 'TestSideEffect'. The provided function returns the new state in an 'IO' monad that can also perform the side effects.
-}</span></span><span>
</span><span id="line-275"></span><span id="local-6989586621679292290"><span id="local-6989586621679292291"><span id="local-6989586621679292292"><span id="local-6989586621679292293"><span id="local-6989586621679292294"><span id="local-6989586621679292295"><span id="local-6989586621679292296"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#testSideEffect"><span class="hs-identifier hs-type">testSideEffect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679292290"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292290"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Model.Automaton.html#AutIntrpr"><span class="hs-identifier hs-type">AutIntrpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292291"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292292"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292293"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292294"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292295"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292296"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292296"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679292291"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292293"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679292290"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSideEffect"><span class="hs-identifier hs-type">TestSideEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292291"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292292"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292293"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292294"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292295"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292296"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292290"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-276"></span><span id="testSideEffect"><span class="annot"><span class="annottext">testSideEffect :: forall s (m :: * -&gt; *) loc q t tdest act.
s
-&gt; (s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s)
-&gt; TestSideEffect m loc q t tdest act s
</span><a href="Lattest.Exec.StandardTestControllers.html#testSideEffect"><span class="hs-identifier hs-var hs-var">testSideEffect</span></a></span></span><span> </span><span id="local-6989586621679292689"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292689"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679292690"><span class="annot"><span class="annottext">s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s
</span><a href="#local-6989586621679292690"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
-&gt; (s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s)
-&gt; (s -&gt; IO ())
-&gt; TestObserver m loc q t tdest act s ()
forall s (m :: * -&gt; *) loc q t tdest act r.
s
-&gt; (s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s)
-&gt; (s -&gt; IO r)
-&gt; TestObserver m loc q t tdest act s r
</span><a href="Lattest.Exec.StandardTestControllers.html#observer"><span class="hs-identifier hs-var">observer</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679292689"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s
</span><a href="#local-6989586621679292690"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; s -&gt; IO ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; s -&gt; IO ()) -&gt; IO () -&gt; s -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><span class="hs-comment">{- |
    Print observed to stdin actions during testing.
-}</span></span><span>
</span><span id="line-281"></span><span id="local-6989586621679292305"><span id="local-6989586621679292306"><span id="local-6989586621679292307"><span id="local-6989586621679292308"><span id="local-6989586621679292309"><span id="local-6989586621679292310"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#printActions"><span class="hs-identifier hs-type">printActions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679292305"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSideEffect"><span class="hs-identifier hs-type">TestSideEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292306"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292307"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292308"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292309"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292310"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292305"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-282"></span><span id="printActions"><span class="annot"><span class="annottext">printActions :: forall act (m :: * -&gt; *) loc q t tdest.
Show act =&gt;
TestSideEffect m loc q t tdest act ()
</span><a href="Lattest.Exec.StandardTestControllers.html#printActions"><span class="hs-identifier hs-var hs-var">printActions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">()
-&gt; (() -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO ())
-&gt; TestSideEffect m loc q t tdest act ()
forall s (m :: * -&gt; *) loc q t tdest act.
s
-&gt; (s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s)
-&gt; TestSideEffect m loc q t tdest act s
</span><a href="Lattest.Exec.StandardTestControllers.html#testSideEffect"><span class="hs-identifier hs-var">testSideEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679292693"><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292693"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="annot"><span class="annottext">m q
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">act -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">act
</span><a href="#local-6989586621679292693"><span class="hs-identifier hs-var">act</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><span class="hs-comment">{- |
    Print the state configuration of the specification during testing.
-}</span></span><span>
</span><span id="line-287"></span><span id="local-6989586621679292318"><span id="local-6989586621679292319"><span id="local-6989586621679292320"><span id="local-6989586621679292321"><span id="local-6989586621679292322"><span id="local-6989586621679292323"><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#printState"><span class="hs-identifier hs-type">printState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679292318"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292319"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Lattest.Exec.StandardTestControllers.html#TestSideEffect"><span class="hs-identifier hs-type">TestSideEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292318"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292320"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292319"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292321"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292322"><span class="hs-identifier hs-type">tdest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679292323"><span class="hs-identifier hs-type">act</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-288"></span><span id="printState"><span class="annot"><span class="annottext">printState :: forall (m :: * -&gt; *) q loc t tdest act.
Show (m q) =&gt;
TestSideEffect m loc q t tdest act ()
</span><a href="Lattest.Exec.StandardTestControllers.html#printState"><span class="hs-identifier hs-var hs-var">printState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">()
-&gt; (() -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO ())
-&gt; TestSideEffect m loc q t tdest act ()
forall s (m :: * -&gt; *) loc q t tdest act.
s
-&gt; (s -&gt; AutIntrpr m loc q t tdest act -&gt; act -&gt; m q -&gt; IO s)
-&gt; TestSideEffect m loc q t tdest act s
</span><a href="Lattest.Exec.StandardTestControllers.html#testSideEffect"><span class="hs-identifier hs-var">testSideEffect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AutIntrpr m loc q t tdest act
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">act
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679292698"><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292698"><span class="hs-identifier hs-var">mq</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO ()) -&gt; [Char] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">m q -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">m q
</span><a href="#local-6989586621679292698"><span class="hs-identifier hs-var">mq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span></pre></body></html>